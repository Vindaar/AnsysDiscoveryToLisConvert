* ANSYS Discovery Aim conversion tool

This is a simple tool, which converts files generated from ANSYS
Discovery Aim to so called LIS files (used by regular ANSYS afaik?
and) expected by [[https://garfieldpp.web.cern.ch/garfieldpp/][Garfield++]] to simulate particle interactions based on
models generated by ANSYS.

It should be as simple as handing the following files:
- a =mesh.dat= from the project directory of the Discovery Aim project
- a =potentials.csv= file exported from Discoverd Aim via the GUI

The path under Windows for the former might look something like:
#+BEGIN_SRC sh
C:\Users\<UserName>\Documents\Ansys\<ProjectName>\<ProjectName?>_files\dp0\Study\AIM\physics1\mesh.dat
#+END_SRC
(I don't know the details of what of the path is based on naming of
the project, but this should get you there).

And it will generate:
- ELIST.lis: mapping of nodes to elements
- NLIST.lis: mapping of nodes to coordinates
- PRNSOL.lis: simulation result mapping nodes to electric field

The final file:
- MPLIST.lis: list of used materials
currently has to be generated manually.

** Things to keep in mind

- the meshing created by ANSYS Discovery Aim must not use the SOLID122
  geometry, which is a 20 node element. Garfield can only deal with up
  to 10 node elements, see:
  - https://www.mm.bme.hu/~gyebro/files/vem/ansys_14_element_reference.pdf#SOLID122
  - https://gitlab.cern.ch/garfield/garfieldpp/-/blob/master/Source/ComponentAnsys123.cc#L308-334
  - slide 23: https://indico.cern.ch/event/258852/contributions/1589835/attachments/456028/632040/zaragoza.pdf
- the material ids founde in the mesh.dat file (sometimes?) don't
  start at 1. I don't know whether that has a reason or not, but we
  have to subtract the minimum so that they do start at 1. Otherwise
  Garfield is confused.
- check the following two files to create the MPLIST.lis file:
  - [[<ProjectName>/session_files/journal1.wbjn]]: get the actual
    assignments of the different materials from this file, look for
    the parts like this:
    #+BEGIN_SRC 
        materialAssignment1 = study1.CreateEntity(
        Type="MaterialAssignment",
        Association=physicsDefinition1)
    material1 = study1.CreateEntity(
        Type="Material",
        Association=physicsDefinition1)
    material1.ImportEngineeringData(Name="Air")
    materialAssignment1.Material = material1
    materialAssignment1.Location = ["BODY1"]
    materialAssignment2 = study1.CreateEntity(
        Type="MaterialAssignment",
        Association=physicsDefinition1)
    material2 = study1.CreateEntity(
        Type="Material",
        Association=physicsDefinition1)
    material2.ImportEngineeringData(Name="Teflon (tm)")
    materialAssignment2.Material = material2
    materialAssignment2.Location = ["BODY2", "BODY9"]
    # ... and so on
    #+END_SRC
    Here we see that material 1 is air, material 2 is teflon etc.
  - [[<ProjectName>/report_files/dp0/Study/AIM/report.xml]]: This XML file
    contains all physical properties for each material. The
    interesting parts for the MPLIST file are found in sections like
    this:
    #+BEGIN_SRC xml
    <section name="Air">
      <table name="" showHeaders="true" collapsible="true" nameHasEncoding="false">
        <column name="Property" id="Property" />
        <column name="Value" id="Value" />
        <row><value showRawHtml="true">Molar mass</value><value showRawHtml="true">28,965 [kg kmol^-1]</value></row>
      </table>
      <table name="Liquid Properties" showHeaders="true" collapsible="true" nameHasEncoding="false">
        <column name="Property" id="Property" />
        <column name="Value" id="Value" />
        <row><value showRawHtml="true">Density, &#x3c1;</value><value showRawHtml="true">875,2 [kg m^-3]</value></row>
        <row><value showRawHtml="true">Specific heat, c<sub>p</sub></value><value showRawHtml="true">1932,9 [J kg^-1 C^-1]</value></row>
        <row><value showRawHtml="true">Viscosity, &#x3bc;</value><value showRawHtml="true">0,00016668 [Pa s]</value></row>
        <row><value showRawHtml="true">Isotropic thermal conductivity, k</value><value showRawHtml="true">0,13999 [W m^-1 C^-1]</value></row>
      </table>
      <table name="Gas Properties" showHeaders="true" collapsible="true" nameHasEncoding="false">
        <column name="Property" id="Property" />
        <column name="Value" id="Value" />
        <row><value showRawHtml="true">Density, &#x3c1;</value><value showRawHtml="true">1,1843 [kg m^-3]</value></row>
        <row><value showRawHtml="true">Specific heat, c<sub>p</sub></value><value showRawHtml="true">1006,3 [J kg^-1 C^-1]</value></row>
        <row><value showRawHtml="true">Viscosity, &#x3bc;</value><value showRawHtml="true">1,8448E-05 [Pa s]</value></row>
        <row><value showRawHtml="true">Isotropic thermal conductivity, k</value><value showRawHtml="true">0,026247 [W m^-1 C^-1]</value></row>
        <row><value showRawHtml="true">Isotropic electrical conductivity, &#x3C3;</value><value showRawHtml="true">0 [S m^-1]</value></row>
        <row><value showRawHtml="true">Isotropic relative permeability, &#x3bc;<sub>r</sub></value><value showRawHtml="true">1.0000004</value></row>
        <row><value showRawHtml="true">Isotropic relative permittivity, &#x3b5;<sub>r</sub></value><value showRawHtml="true">1.0006</value></row>
      </table>
    </section>
    ... 
    #+END_SRC
    where the section name is the same one as found in the journal
    file mentioned before. 
  - for the MPLIST file all we need for our electric field based
    simulionsa are:
    - RSVX = resistivity, use the inverse of the "Isotropic electrical
      conductivity" from the XML file above.
    - PERX = electric relative permittivity
    An example file then looks like:
    #+BEGIN_SRC 
    
 LIST MATERIALS        1 TO        5 BY        1
  PROPERTY= ALL


 MATERIAL NUMBER        1

      TEMP        PERX
                1.0006

 MATERIAL NUMBER        2

      TEMP        PERX
                2.100000

 MATERIAL NUMBER        3

      TEMP        PERX
                7.000000

 MATERIAL NUMBER        4

      TEMP        RSVX
                1.7241E-8

      TEMP        PERX
                1.000000

  MATERIAL NUMBER        5

      TEMP        RSVX
                2.68456e-11

      TEMP        PERX
                10.80000
    #+END_SRC


** References

List of different acronyms used in MPLIST to describe materials:
- https://www.mm.bme.hu/~gyebro/files/ans_help_v182/ans_cmd/Hlp_C_MP.html

| Acronym | Meaning                                                                                                                                                                                              |
|---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ALPD    | Mass matrix multiplier for damping.                                                                                                                                                                  |
| ALPX    | Secant coefficients of thermal expansion (also ALPY, ALPZ).                                                                                                                                          |
| BETD    | Stiffness matrix multiplier for damping. *                                                                                                                                                           |
| BETX    | Coefficient of diffusion expansion (also BETY, BETZ)                                                                                                                                                 |
| BVIS    | Bulk viscosity                                                                                                                                                                                       |
| C       | Specific heat                                                                                                                                                                                        |
| CREF    | Reference concentration (may not be temperature dependent)                                                                                                                                           |
| CSAT    | Saturated concentration                                                                                                                                                                              |
| CTEX    | Instantaneous coefficients of thermal expansion (also CTEY, CTEZ)                                                                                                                                    |
| CVH     | Heat coefficient at constant volume per unit of mass                                                                                                                                                 |
| DENS    | Mass density.                                                                                                                                                                                        |
| DMPR    | Constant structural damping coefficient in harmonic analysis **                                                                                                                                      |
| DXX     | Diffusivity coefficients (also DYY, DZZ)                                                                                                                                                             |
| EMIS    | Emissivity.                                                                                                                                                                                          |
| ENTH    | Enthalpy.                                                                                                                                                                                            |
| EX      | Elastic moduli (also EY, EZ)                                                                                                                                                                         |
| GXY     | Shear moduli (also GYZ, GXZ)                                                                                                                                                                         |
| HF      | Convection or film coefficient                                                                                                                                                                       |
| KXX     | Thermal conductivities (also KYY, KZZ)                                                                                                                                                               |
| LSST    | Electric loss tangent                                                                                                                                                                                |
| LSSM    | Magnetic loss tangent                                                                                                                                                                                |
| MGXX    | Magnetic coercive forces (also MGYY, MGZZ)                                                                                                                                                           |
| MURX    | Magnetic relative permeabilities (also MURY, MURZ)                                                                                                                                                   |
| MU      | Coefficient of friction                                                                                                                                                                              |
| NUXY    | Minor Poisson's ratios (also NUYZ, NUXZ) (NUXY = νyx, as described in Stress-Strain Relationships in the Mechanical APDL Theory Reference)                                                           |
| PERX    | Electric relative permittivities (also PERY, PERZ) ***                                                                                                                                               |
| PRXY    | Major Poisson's ratios (also PRYZ, PRXZ) (PRXY = νxy, as described in Stress-Strain Relationships in the Mechanical APDL Theory Reference)                                                           |
| QRATE   | Heat generation rate for thermal mass element MASS71. Fraction of plastic work converted to heat (Taylor-Quinney coefficient) for coupled-field elements PLANE222, PLANE223, SOLID226, and SOLID227. |
| REFT    | Reference temperature. Must be defined as a constant; C1 through C4 are ignored.                                                                                                                     |
| RH      | Hall Coefficient.                                                                                                                                                                                    |
| RSVX    | Electrical resistivities (also RSVY, RSVZ).                                                                                                                                                          |
| SBKX    | Seebeck coefficients (also SBKY, SBKZ).                                                                                                                                                              |
| SONC    | Sonic velocity.                                                                                                                                                                                      |
| THSX    | Thermal strain (also THSY, THSZ).                                                                                                                                                                    |
| VISC    | Viscosity.                                                                                                                                                                                           |


- ~*~: If used in an explicit dynamic analysis, the value corresponds
  to the percentage of damping in the high frequency domain. For
  example, 0.1 roughly corresponds to 10% damping in the high frequency domain.
- ~**~: (full and QRDAMP mode-superposition). Damping ratio in
  non-QRDAMP mode-superposition analysis. As a constant structural
  damping coefficient, it is also supported in transient analyses
  (full and QRDAMP mode-superposition) when an average excitation
  frequency is specified (DMPSFreq on TRNOPT). 
- ~***~: If you enter permittivity values less than 1 for SOLID5,
  PLANE13, or SOLID98, the program interprets the values as absolute 
  permittivity. Values input for PLANE223, SOLID226, or SOLID227 are
  always interpreted as relative permittivity.  
